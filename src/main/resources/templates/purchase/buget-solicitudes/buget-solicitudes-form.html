<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:replace="fragments/head :: head"></div>
    <link rel="stylesheet" th:href="@{/css/product/add-product.css}">
    <link rel="stylesheet" th:href="@{/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css}">
    <!-- Select2 -->
    <link rel="stylesheet" th:href="@{/bower_components/select2/dist/css/select2.css}">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

</head>
<body class="hold-transition skin-blue sidebar-mini">

<!-- Site wrapper -->
<div class="wrapper">
    <div th:replace="fragments/header :: header"></div>
    <div th:replace="fragments/menu :: menu"></div>
    <div>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <h1>
                    Producto
                    <small>módulo de compras</small>
                </h1>
                <ol class="breadcrumb">
                    <li><a href="#"><i class="fa fa-dashboard"></i> Inicio</a></li>
                    <li><a href="#">Compras</a></li>
                    <li class="active">Soliciutd de presupuesto</li>
                </ol>
            </section>

            <!-- Main content -->
            <section class="content">

                <!-- Default box -->
                <div class="box">
                    <div class="box-body">
                        <div class="row">
                            <form action="#" th:action="@{/purchase/bugetSolicutdes}" th:object="${buget}" method="post"
                                  enctype="multipart/form-data">
                                <div class="col-lg-6">

                                    <input type="hidden" th:field="*{id}"/>

                                    <div class="form-group">
                                        <div class="form-group has-feedback">
                                            <label for="description">Descripción</label>
                                            <input placeholder="Pedido de compras" type="text" id="description"
                                                   class="form-control"
                                                   th:field="*{description}">
                                            <small class="form-text text-danger"
                                                   th:if="${#fields.hasErrors('description')}"
                                                   th:errors="*{description}"></small>
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="brand">Categoría</label>
                                        <select class="form-control" id="brand" th:field="*{category}">
                                            <option value="0">--SELECCIONE UNA Categoría--</option>
                                            <option th:each="category : ${categories}"
                                                    th:value="${category.id}"
                                                    th:text="${category.description}">
                                            </option>
                                        </select>
                                        <small class="form-text text-danger" th:if="${#fields.hasErrors('category')}"
                                               th:errors="*{category}"></small>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="form-group has-feedback">
                                            <label for="initDate">Inicio</label>
                                            <input placeholder="01-01-2019" type="text" id="initDate"
                                                   class="form-control"
                                                   th:field="*{initDate}">
                                            <small class="form-text text-danger"
                                                   th:if="${#fields.hasErrors('initDate')}"
                                                   th:errors="*{initDate}"></small>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="form-group has-feedback">
                                            <label for="endDate">Fin</label>
                                            <input placeholder="01-01-2019" type="text" id="endDate"
                                                   class="form-control"
                                                   th:field="*{endDate}">
                                            <small class="form-text text-danger" th:if="${#fields.hasErrors('endDate')}"
                                                   th:errors="*{endDate}"></small>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-lg-12" id="productsform">

                                    <table class="table table-bordered table-striped">
                                        <tr>
                                            <th>Producto</th>
                                            <th>Cantidad</th>
                                            <th>Acción</th>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="form-group" data-select2-id="27">
                                                    <select class="form-control select2"
                                                            style="width: 100%;" data-select2-id="9" tabindex="-1"
                                                            v-model="productId"
                                                            aria-hidden="true">
                                                        <option th:each="product : ${products}"
                                                                th:value="${product}"
                                                                th:text="${product.productName}">
                                                        </option>
                                                    </select>
                                                </div>


                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <div class="form-group has-feedback">
                                                        <input placeholder="10" type="number" min="1" id="10"
                                                               class="form-control"
                                                               v-model="quantity"
                                                               style="text-align: right;">
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <button type="button" id="add-product" onclick="addProduct()"
                                                        class="btn btn-primary"><i class="fa fa-plus"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </table>


            </section>
            <!-- Tabla donde se muestran los datos -->
            <section class="data">
                <caption>Productos</caption>
                <table class="table" id="added-products">
                    <thead>
                    <tr>
                        <th scope="col">id</th>
                        <th scope="col">producto</th>
                        <th scope="col">Cantidad</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>

                    <tr th:each="product : ${buget.productList}">
                        <td th:text="${product.productName}">
                        </td>
                    </tr>

                    </tbody>
                </table>
            </section>

        </div>

        <div class="col-lg-12">
            <button type="submit" class="btn btn-primary"><i class="fa fa-save"></i> Guardar
            </button>
        </div>
        </form>
    </div>

</div>
</div>
<!-- /.box -->

</section>
<!-- /.content -->
</div>
<!-- /.content-wrapper -->

</div>
<div th:replace="fragments/footer :: footer"></div>
<div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->
<div th:replace="fragments/head :: footer-js"></div>
<script th:src="@{/js/product/add-product.js}"></script>
<script th:src="@{/bower_components/bootstrap/js/bootstrap3-typeahead.min.js}"></script>
<script th:src="@{/bower_components/select2/dist/js/select2.js}"></script>

<!-- Bootstrap WYSIHTML5 -->
<script th:src="@{/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js}"></script>
<script>
    $(function () {
        $('.textarea').wysihtml5();

        $('.select2').select2();

        $('#productAutoComplete').typeahead({
            source: function (query, result) {
                $.ajax({
                    url: "/purchase/products/list",
                    data: 'name=' + query,
                    dataType: "json",
                    type: "GET",
                    success: function (data) {
                        result($.map(data, function (item) {
                            console.log(item);
                            return item.product_name;
                        }));
                    }
                });
            }
        });
    });

    function addProduct(){
        $('#added-products tr:last').after('<tr></tr><tr>...</tr>');
    }




</script>

</body>
</html>
